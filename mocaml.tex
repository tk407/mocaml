% generated by Ott 0.23 from: ./../../../mocaml/mocaml2.ott
\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{geometry}
\usepackage{ifthen}
\usepackage{alltt}%hack
\geometry{a4paper,dvips,twoside,left=22.5mm,right=22.5mm,top=20mm,bottom=30mm}
\usepackage{color}
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{value\_name} ,\, \ottmv{x} $ &  \\
 $ \ottmv{ident} $ &  \\
 $ \ottmv{integer\_literal} $ &  \\
 $ \ottmv{index} ,\, \ottmv{i} ,\, \ottmv{j} ,\, \ottmv{n} ,\, \ottmv{m} $ &  \\
}}

\newcommand{\otttypeconstr}{
\ottrulehead{\ottnt{typeconstr}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{unit}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{bool}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{int}}{}{}{}{}}

\newcommand{\otttypvar}{
\ottrulehead{\ottnt{typvar}  ,\ \ottnt{tv}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottsym{'}  \ottmv{ident}}{}{}{}{}}

\newcommand{\otttypexpr}{
\ottrulehead{\ottnt{typexpr}  ,\ \ottnt{t}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{typvar}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typexpr}  \rightarrow  \ottnt{typexpr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typeconstr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typexpr}  *  \ottnt{typexpr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\textbf{concurrent} \, \ottnt{typexpr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typexpr}  +  \ottnt{typexpr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{typexpr}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\otttypscheme}{
\ottrulehead{\ottnt{typscheme}  ,\ \ottnt{ts}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottsym{(}  \ottnt{typvar_{{\mathrm{1}}}}  , \, .. \, ,  \ottnt{typvar_{\ottmv{n}}}  \ottsym{)}  \ottnt{typexpr}}{}{\textsf{bind}\; \ottnt{typvar_{{\mathrm{1}}}}..\ottnt{typvar_{\ottmv{n}}}\; \textsf{in}\; \ottnt{typexpr}}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{generalise} \, \ottsym{(}  \Gamma  ,  \ottnt{t}  \ottsym{)}} {\textsf{M}}{}{}{}}

\newcommand{\ottconstant}{
\ottrulehead{\ottnt{constant}  ,\ \ottnt{c}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{integer\_literal}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{false}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{true}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{()}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(\&\&)}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{not}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{ret}}{}{}{}{}}

\newcommand{\ottexpr}{
\ottrulehead{\ottnt{expr}  ,\ \ottnt{e}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{value\_name}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{constant}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{expr} \, \ottnt{expr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{expr}  >>=  \ottnt{expr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Fork \, \ottnt{expr} \, \ottnt{expr'}  >!=  \ottnt{expr''}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\textbf{function} \, \ottmv{value\_name}  \rightarrow  \ottnt{expr}}{}{\textsf{bind}\; \ottmv{value\_name}\; \textsf{in}\; \ottnt{expr}}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{let} \, \ottmv{value\_name}  \ottsym{=}  \ottnt{expr} \, \ottkw{in} \, \ottnt{expr'}}{}{\textsf{bind}\; \ottmv{value\_name}\; \textsf{in}\; \ottnt{expr'}}{}{}\ottprodnewline
\ottprodline{|}{Live \, \ottnt{expr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Dead \, \ottnt{value}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Fork \, \ottnt{expr} \, \ottnt{expr'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\{  \ottnt{e}  ,  \ottnt{e'}  \}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{expr}  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{Left tag \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Right tag \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Case \, \ottnt{e_{{\mathrm{1}}}} \, of \, Left tag \, \ottmv{x_{{\mathrm{1}}}}  \Rightarrow  \ottnt{e_{{\mathrm{2}}}}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x_{{\mathrm{2}}}}  \Rightarrow  \ottnt{e_{{\mathrm{3}}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\{  \ottnt{v}  \ottsym{/}  \ottmv{x}  \}  \ottnt{e}} {\textsf{M}}{}{}{}}

\newcommand{\ottvalue}{
\ottrulehead{\ottnt{value}  ,\ \ottnt{v}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{constant}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\textbf{function} \, \ottmv{value\_name}  \rightarrow  \ottnt{expr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Left tag \, \ottnt{v}}{}{}{}{}\ottprodnewline
\ottprodline{|}{Right tag \, \ottnt{v}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\{  \ottnt{v}  ,  \ottnt{v'}  \}}{}{}{}{}}

\newcommand{\ottG}{
\ottrulehead{\Gamma}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  ,  \ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme}}{}{}{}{}}

\newcommand{\ottformula}{
\ottrulehead{\ottnt{formula}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{judgement}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{not} \, \ottsym{(}  \ottnt{formula}  \ottsym{)}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typscheme}  \ottsym{>}  \ottnt{t}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typscheme}  \ottsym{=}  \ottnt{typscheme'}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{value\_name}  \ottsym{=}  \ottmv{value\_name'}}{}{}{}{}}

\newcommand{\ottterminals}{
\ottrulehead{\ottnt{terminals}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \rightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \textbf{function} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \vdash }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \longrightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \{ }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \textbf{concurrent} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Live }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Dead }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Fork }{}{}{}{}\ottprodnewline
\ottprodline{|}{ >>= }{}{}{}{}\ottprodnewline
\ottprodline{|}{ >!= }{}{}{}{}\ottprodnewline
\ottprodline{|}{ * }{}{}{}{}\ottprodnewline
\ottprodline{|}{ , }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Left tag }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Right tag }{}{}{}{}\ottprodnewline
\ottprodline{|}{ Case }{}{}{}{}\ottprodnewline
\ottprodline{|}{ of }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \Rightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ + }{}{}{}{}}

\newcommand{\ottJtype}{
\ottrulehead{\ottnt{Jtype}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{constant}  \ottsym{:}  \ottnt{t}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}{}{}{}{}}

\newcommand{\ottJop}{
\ottrulehead{\ottnt{Jop}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{e}  \longrightarrow  \ottnt{e'}}{}{}{}{}}

\newcommand{\ottjudgement}{
\ottrulehead{\ottnt{judgement}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{Jtype}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{Jop}}{}{}{}{}}

\newcommand{\ottuserXXsyntax}{
\ottrulehead{\ottnt{user\_syntax}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{value\_name}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{ident}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{integer\_literal}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{index}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typeconstr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typvar}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typexpr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typscheme}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{constant}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{expr}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{value}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{formula}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{terminals}}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttypeconstr\ottinterrule
\otttypvar\ottinterrule
\otttypexpr\ottinterrule
\otttypscheme\ottinterrule
\ottconstant\ottinterrule
\ottexpr\ottinterrule
\ottvalue\ottinterrule
\ottG\ottinterrule
\ottformula\ottinterrule
\ottterminals\ottinterrule
\ottJtype\ottinterrule
\ottJop\ottinterrule
\ottjudgement\ottinterrule
\ottuserXXsyntax\ottafterlastrule
}}

% defnss
% defns Jtype
%% defn VTSin
\newcommand{\ottdruleVTSinXXvnOne}[1]{\ottdrule[#1]{%
}{
\ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma  ,  \ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme}}{%
{\ottdrulename{VTSin\_vn1}}{}%
}}


\newcommand{\ottdruleVTSinXXvnTwo}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma}%
\ottpremise{\ottkw{not} \, \ottsym{(}  \ottmv{value\_name}  \ottsym{=}  \ottmv{value\_name'}  \ottsym{)}}%
}{
\ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma  ,  \ottmv{value\_name'}  \ottsym{:}  \ottnt{typscheme'}}{%
{\ottdrulename{VTSin\_vn2}}{}%
}}

\newcommand{\ottdefnVTSin}[1]{\begin{ottdefnblock}[#1]{$\ottmv{value\_name}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma$}{}
\ottusedrule{\ottdruleVTSinXXvnOne{}}
\ottusedrule{\ottdruleVTSinXXvnTwo{}}
\end{ottdefnblock}}

%% defn G_constant
\newcommand{\ottdruleconstantXXint}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottmv{integer\_literal}  \ottsym{:}  \ottkw{int}}{%
{\ottdrulename{constant\_int}}{}%
}}


\newcommand{\ottdruleconstantXXfalse}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottkw{false}  \ottsym{:}  \ottkw{bool}}{%
{\ottdrulename{constant\_false}}{}%
}}


\newcommand{\ottdruleconstantXXtrue}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottkw{true}  \ottsym{:}  \ottkw{bool}}{%
{\ottdrulename{constant\_true}}{}%
}}


\newcommand{\ottdruleconstantXXunit}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottsym{()}  \ottsym{:}  \ottkw{unit}}{%
{\ottdrulename{constant\_unit}}{}%
}}


\newcommand{\ottdruleconstantXXand}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottsym{(\&\&)}  \ottsym{:}  \ottkw{bool}  \rightarrow  \ottsym{(}  \ottkw{bool}  \rightarrow  \ottkw{bool}  \ottsym{)}}{%
{\ottdrulename{constant\_and}}{}%
}}


\newcommand{\ottdruleconstantXXnot}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottkw{not}  \ottsym{:}  \ottkw{bool}  \rightarrow  \ottkw{bool}}{%
{\ottdrulename{constant\_not}}{}%
}}


\newcommand{\ottdruleconstantXXret}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottkw{ret}  \ottsym{:}  \ottnt{t}  \rightarrow  \textbf{concurrent} \, \ottnt{t}}{%
{\ottdrulename{constant\_ret}}{}%
}}

\newcommand{\ottdefnGXXconstant}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{constant}  \ottsym{:}  \ottnt{t}$}{}
\ottusedrule{\ottdruleconstantXXint{}}
\ottusedrule{\ottdruleconstantXXfalse{}}
\ottusedrule{\ottdruleconstantXXtrue{}}
\ottusedrule{\ottdruleconstantXXunit{}}
\ottusedrule{\ottdruleconstantXXand{}}
\ottusedrule{\ottdruleconstantXXnot{}}
\ottusedrule{\ottdruleconstantXXret{}}
\end{ottdefnblock}}

%% defn Get
\newcommand{\ottdruleGetXXvalueXXname}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{typscheme} \, \ottkw{in} \, \Gamma}%
\ottpremise{\ottnt{typscheme}  \ottsym{>}  \ottnt{t}}%
}{
\Gamma  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Get\_value\_name}}{}%
}}


\newcommand{\ottdruleGetXXconstant}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{constant}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  \ottnt{constant}  \ottsym{:}  \ottnt{t}}{%
{\ottdrulename{Get\_constant}}{}%
}}


\newcommand{\ottdruleGetXXapply}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}  \rightarrow  \ottnt{t_{{\mathrm{2}}}}}%
\ottpremise{\Gamma  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}}%
}{
\Gamma  \vdash  \ottnt{e} \, \ottnt{e'}  \ottsym{:}  \ottnt{t_{{\mathrm{2}}}}}{%
{\ottdrulename{Get\_apply}}{}%
}}


\newcommand{\ottdruleGetXXlambda}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  ,  \ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \ottsym{(}  \,  \ottsym{)}  \ottnt{t_{{\mathrm{1}}}}  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  \textbf{function} \, \ottmv{x_{{\mathrm{1}}}}  \rightarrow  \ottnt{e}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}  \rightarrow  \ottnt{t}}{%
{\ottdrulename{Get\_lambda}}{}%
}}


\newcommand{\ottdruleGetXXlive}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  Live \, \ottnt{e}  \ottsym{:}  \textbf{concurrent} \, \ottnt{t}}{%
{\ottdrulename{Get\_live}}{}%
}}


\newcommand{\ottdruleGetXXdead}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{v}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  Dead \, \ottnt{v}  \ottsym{:}  \textbf{concurrent} \, \ottnt{t}}{%
{\ottdrulename{Get\_dead}}{}%
}}


\newcommand{\ottdruleGetXXfork}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}}%
\ottpremise{\Gamma  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t_{{\mathrm{2}}}}}%
}{
\Gamma  \vdash  Fork \, \ottnt{e} \, \ottnt{e'}  \ottsym{:}  \textbf{concurrent} \, \ottsym{(}  \ottnt{t_{{\mathrm{1}}}}  *  \ottnt{t_{{\mathrm{2}}}}  \ottsym{)}}{%
{\ottdrulename{Get\_fork}}{}%
}}


\newcommand{\ottdruleGetXXbind}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \textbf{concurrent} \, \ottnt{t}}%
\ottpremise{\Gamma  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t}  \rightarrow  \textbf{concurrent} \, \ottnt{t'}}%
}{
\Gamma  \vdash  \ottnt{e}  >>=  \ottnt{e'}  \ottsym{:}  \textbf{concurrent} \, \ottnt{t'}}{%
{\ottdrulename{Get\_bind}}{}%
}}


\newcommand{\ottdruleGetXXcutin}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e''}  \ottsym{:}  \ottsym{(}  \ottsym{(}  \ottsym{(}  \ottsym{(}  \ottnt{t'}  *  \ottnt{t''}  \ottsym{)}  +  \ottsym{(}  \ottnt{t'}  *  \ottsym{(}  \textbf{concurrent} \, \ottnt{t''}  \ottsym{)}  \ottsym{)}  \ottsym{)}  +  \ottsym{(}  \ottsym{(}  \textbf{concurrent} \, \ottnt{t'}  \ottsym{)}  *  \ottnt{t''}  \ottsym{)}  \ottsym{)}  \rightarrow  \textbf{concurrent} \, \ottnt{t}  \ottsym{)}}%
\ottpremise{\Gamma  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t''}}%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t'}}%
}{
\Gamma  \vdash  Fork \, \ottnt{e} \, \ottnt{e'}  >!=  \ottnt{e''}  \ottsym{:}  \textbf{concurrent} \, \ottnt{t}}{%
{\ottdrulename{Get\_cutin}}{}%
}}


\newcommand{\ottdruleGetXXpair}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t_{{\mathrm{1}}}}}%
\ottpremise{\Gamma  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t_{{\mathrm{2}}}}}%
}{
\Gamma  \vdash  \{  \ottnt{e}  ,  \ottnt{e'}  \}  \ottsym{:}  \ottsym{(}  \ottnt{t_{{\mathrm{1}}}}  *  \ottnt{t_{{\mathrm{2}}}}  \ottsym{)}}{%
{\ottdrulename{Get\_pair}}{}%
}}


\newcommand{\ottdruleGetXXlet}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
\ottpremise{\Gamma  ,  \ottmv{x}  \ottsym{:}  \ottnt{typscheme}  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t'}}%
\ottpremise{\ottnt{typscheme}  \ottsym{=}  \ottkw{generalise} \, \ottsym{(}  \Gamma  ,  \ottnt{t}  \ottsym{)}}%
}{
\Gamma  \vdash  \ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{e} \, \ottkw{in} \, \ottnt{e'}  \ottsym{:}  \ottnt{t'}}{%
{\ottdrulename{Get\_let}}{}%
}}


\newcommand{\ottdruleGetXXTInl}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  Left tag \, \ottnt{e}  \ottsym{:}  \ottnt{t}  +  \ottnt{t'}}{%
{\ottdrulename{Get\_TInl}}{}%
}}


\newcommand{\ottdruleGetXXTInr}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}}%
}{
\Gamma  \vdash  Right tag \, \ottnt{e}  \ottsym{:}  \ottnt{t'}  +  \ottnt{t}}{%
{\ottdrulename{Get\_TInr}}{}%
}}


\newcommand{\ottdruleGetXXTCase}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}  +  \ottnt{t'}}%
\ottpremise{\Gamma  ,  \ottmv{x}  \ottsym{:}  \ottsym{(}  \,  \ottsym{)}  \ottnt{t}  \vdash  \ottnt{e'}  \ottsym{:}  \ottnt{t''}}%
\ottpremise{\Gamma  ,  \ottmv{x'}  \ottsym{:}  \ottsym{(}  \,  \ottsym{)}  \ottnt{t'}  \vdash  \ottnt{e''}  \ottsym{:}  \ottnt{t''}}%
}{
\Gamma  \vdash  Case \, \ottnt{e} \, of \, Left tag \, \ottmv{x}  \Rightarrow  \ottnt{e'}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x'}  \Rightarrow  \ottnt{e''}  \ottsym{:}  \ottnt{t''}}{%
{\ottdrulename{Get\_TCase}}{}%
}}

\newcommand{\ottdefnGet}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{t}$}{}
\ottusedrule{\ottdruleGetXXvalueXXname{}}
\ottusedrule{\ottdruleGetXXconstant{}}
\ottusedrule{\ottdruleGetXXapply{}}
\ottusedrule{\ottdruleGetXXlambda{}}
\ottusedrule{\ottdruleGetXXlive{}}
\ottusedrule{\ottdruleGetXXdead{}}
\ottusedrule{\ottdruleGetXXfork{}}
\ottusedrule{\ottdruleGetXXbind{}}
\ottusedrule{\ottdruleGetXXcutin{}}
\ottusedrule{\ottdruleGetXXpair{}}
\ottusedrule{\ottdruleGetXXlet{}}
\ottusedrule{\ottdruleGetXXTInl{}}
\ottusedrule{\ottdruleGetXXTInr{}}
\ottusedrule{\ottdruleGetXXTCase{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsJtype}{
\ottdefnVTSin{}\ottdefnGXXconstant{}\ottdefnGet{}}

% defns Jop
%% defn red
\newcommand{\ottdruleJOXXredXXapp}[1]{\ottdrule[#1]{%
}{
\ottsym{(}  \textbf{function} \, \ottmv{x}  \rightarrow  \ottnt{e}  \ottsym{)} \, \ottnt{v}  \longrightarrow  \{  \ottnt{v}  \ottsym{/}  \ottmv{x}  \}  \ottnt{e}}{%
{\ottdrulename{JO\_red\_app}}{}%
}}


\newcommand{\ottdruleJOXXredXXlet}[1]{\ottdrule[#1]{%
}{
\ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{v} \, \ottkw{in} \, \ottnt{e}  \longrightarrow  \{  \ottnt{v}  \ottsym{/}  \ottmv{x}  \}  \ottnt{e}}{%
{\ottdrulename{JO\_red\_let}}{}%
}}


\newcommand{\ottdruleJOXXredXXlive}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
Live \, \ottnt{e}  \longrightarrow  Live \, \ottnt{e'}}{%
{\ottdrulename{JO\_red\_live}}{}%
}}


\newcommand{\ottdruleJOXXredXXdie}[1]{\ottdrule[#1]{%
}{
Live \, \ottnt{v}  \longrightarrow  Dead \, \ottnt{v}}{%
{\ottdrulename{JO\_red\_die}}{}%
}}


\newcommand{\ottdruleJOXXredXXforkOne}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e''}}%
}{
Fork \, \ottnt{e} \, \ottnt{e'}  \longrightarrow  Fork \, \ottnt{e''} \, \ottnt{e'}}{%
{\ottdrulename{JO\_red\_fork1}}{}%
}}


\newcommand{\ottdruleJOXXredXXforkTwo}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e'}  \longrightarrow  \ottnt{e''}}%
}{
Fork \, \ottnt{e} \, \ottnt{e'}  \longrightarrow  Fork \, \ottnt{e} \, \ottnt{e''}}{%
{\ottdrulename{JO\_red\_fork2}}{}%
}}


\newcommand{\ottdruleJOXXredXXforkdeath}[1]{\ottdrule[#1]{%
}{
Fork \, \ottnt{v} \, \ottnt{v'}  \longrightarrow  Dead \, \{  \ottnt{v}  ,  \ottnt{v'}  \}}{%
{\ottdrulename{JO\_red\_forkdeath}}{}%
}}


\newcommand{\ottdruleJOXXredXXret}[1]{\ottdrule[#1]{%
}{
\ottkw{ret} \, \ottnt{e}  \longrightarrow  Live \, \ottnt{e}}{%
{\ottdrulename{JO\_red\_ret}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalbind}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\ottnt{e}  >>=  \ottnt{e''}  \longrightarrow  \ottnt{e'}  >>=  \ottnt{e''}}{%
{\ottdrulename{JO\_red\_evalbind}}{}%
}}


\newcommand{\ottdruleJOXXredXXdobind}[1]{\ottdrule[#1]{%
}{
Dead \, \ottnt{v}  >>=  \ottnt{e}  \longrightarrow  \ottnt{e} \, \ottnt{v}}{%
{\ottdrulename{JO\_red\_dobind}}{}%
}}


\newcommand{\ottdruleJOXXredXXcutinOne}[1]{\ottdrule[#1]{%
\ottpremise{Fork \, \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}}  \longrightarrow  Fork \, \ottnt{e_{{\mathrm{4}}}} \, \ottnt{e_{{\mathrm{5}}}}}%
}{
Fork \, \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}}  >!=  \ottnt{e_{{\mathrm{3}}}}  \longrightarrow  Fork \, \ottnt{e_{{\mathrm{4}}}} \, \ottnt{e_{{\mathrm{5}}}}  >!=  \ottnt{e_{{\mathrm{3}}}}}{%
{\ottdrulename{JO\_red\_cutin1}}{}%
}}


\newcommand{\ottdruleJOXXredXXcutinval}[1]{\ottdrule[#1]{%
}{
Fork \, \ottnt{v_{{\mathrm{1}}}} \, \ottnt{v_{{\mathrm{2}}}}  >!=  \ottnt{e_{{\mathrm{3}}}}  \longrightarrow  \ottnt{e_{{\mathrm{3}}}} \, \ottsym{(}  Left tag \, \ottsym{(}  Left tag \, \{  \ottnt{v_{{\mathrm{1}}}}  ,  \ottnt{v_{{\mathrm{2}}}}  \}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{JO\_red\_cutinval}}{}%
}}


\newcommand{\ottdruleJOXXredXXcutinright}[1]{\ottdrule[#1]{%
}{
Fork \, \ottnt{v_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}}  >!=  \ottnt{e_{{\mathrm{3}}}}  \longrightarrow  \ottnt{e_{{\mathrm{3}}}} \, \ottsym{(}  Left tag \, \ottsym{(}  Right tag \, \{  \ottnt{v_{{\mathrm{1}}}}  ,  \ottsym{(}  \ottkw{ret} \, \ottnt{e_{{\mathrm{2}}}}  \ottsym{)}  \}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{JO\_red\_cutinright}}{}%
}}


\newcommand{\ottdruleJOXXredXXcutinright}[1]{\ottdrule[#1]{%
}{
Fork \, \ottnt{e_{{\mathrm{1}}}} \, \ottnt{v_{{\mathrm{2}}}}  >!=  \ottnt{e_{{\mathrm{3}}}}  \longrightarrow  \ottnt{e_{{\mathrm{3}}}} \, \ottsym{(}  Right tag \, \ottsym{(}  Right tag \, \{  \ottsym{(}  \ottkw{ret} \, \ottnt{e_{{\mathrm{1}}}}  \ottsym{)}  ,  \ottnt{v_{{\mathrm{2}}}}  \}  \ottsym{)}  \ottsym{)}}{%
{\ottdrulename{JO\_red\_cutinright}}{}%
}}


\newcommand{\ottdruleJOXXredXXcontextXXappOne}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\ottnt{e} \, \ottnt{e_{{\mathrm{1}}}}  \longrightarrow  \ottnt{e'} \, \ottnt{e_{{\mathrm{1}}}}}{%
{\ottdrulename{JO\_red\_context\_app1}}{}%
}}


\newcommand{\ottdruleJOXXredXXcontextXXappTwo}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\ottnt{v} \, \ottnt{e}  \longrightarrow  \ottnt{v} \, \ottnt{e'}}{%
{\ottdrulename{JO\_red\_context\_app2}}{}%
}}


\newcommand{\ottdruleJOXXredXXcontextXXlet}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{e} \, \ottkw{in} \, \ottnt{e_{{\mathrm{1}}}}  \longrightarrow  \ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{e'} \, \ottkw{in} \, \ottnt{e_{{\mathrm{1}}}}}{%
{\ottdrulename{JO\_red\_context\_let}}{}%
}}


\newcommand{\ottdruleJOXXredXXnotXXOne}[1]{\ottdrule[#1]{%
}{
\ottkw{not} \, \ottkw{true}  \longrightarrow  \ottkw{false}}{%
{\ottdrulename{JO\_red\_not\_1}}{}%
}}


\newcommand{\ottdruleJOXXredXXnotXXTwo}[1]{\ottdrule[#1]{%
}{
\ottkw{not} \, \ottkw{false}  \longrightarrow  \ottkw{true}}{%
{\ottdrulename{JO\_red\_not\_2}}{}%
}}


\newcommand{\ottdruleJOXXredXXandXXOne}[1]{\ottdrule[#1]{%
}{
\ottsym{(}  \ottsym{(\&\&)} \, \ottkw{true}  \ottsym{)} \, \ottnt{e}  \longrightarrow  \ottnt{e}}{%
{\ottdrulename{JO\_red\_and\_1}}{}%
}}


\newcommand{\ottdruleJOXXredXXandXXTwo}[1]{\ottdrule[#1]{%
}{
\ottsym{(}  \ottsym{(\&\&)} \, \ottkw{false}  \ottsym{)} \, \ottnt{e}  \longrightarrow  \ottkw{false}}{%
{\ottdrulename{JO\_red\_and\_2}}{}%
}}


\newcommand{\ottdruleJOXXredXXpairXXOne}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\{  \ottnt{e}  ,  \ottnt{e''}  \}  \longrightarrow  \{  \ottnt{e'}  ,  \ottnt{e''}  \}}{%
{\ottdrulename{JO\_red\_pair\_1}}{}%
}}


\newcommand{\ottdruleJOXXredXXpairXXTwo}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
\{  \ottnt{v}  ,  \ottnt{e}  \}  \longrightarrow  \{  \ottnt{v}  ,  \ottnt{e'}  \}}{%
{\ottdrulename{JO\_red\_pair\_2}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalinl}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
Left tag \, \ottnt{e}  \longrightarrow  Left tag \, \ottnt{e'}}{%
{\ottdrulename{JO\_red\_evalinl}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalinr}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
Right tag \, \ottnt{e}  \longrightarrow  Right tag \, \ottnt{e'}}{%
{\ottdrulename{JO\_red\_evalinr}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalcaseinl}[1]{\ottdrule[#1]{%
}{
Case \, \ottsym{(}  Left tag \, \ottnt{v}  \ottsym{)} \, of \, Left tag \, \ottmv{x}  \Rightarrow  \ottnt{e}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x'}  \Rightarrow  \ottnt{e'}  \longrightarrow  \{  \ottnt{v}  \ottsym{/}  \ottmv{x}  \}  \ottnt{e}}{%
{\ottdrulename{JO\_red\_evalcaseinl}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalcaseinr}[1]{\ottdrule[#1]{%
}{
Case \, \ottsym{(}  Right tag \, \ottnt{v}  \ottsym{)} \, of \, Left tag \, \ottmv{x}  \Rightarrow  \ottnt{e}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x'}  \Rightarrow  \ottnt{e'}  \longrightarrow  \{  \ottnt{v}  \ottsym{/}  \ottmv{x'}  \}  \ottnt{e'}}{%
{\ottdrulename{JO\_red\_evalcaseinr}}{}%
}}


\newcommand{\ottdruleJOXXredXXevalcase}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{e}  \longrightarrow  \ottnt{e'}}%
}{
Case \, \ottnt{e} \, of \, Left tag \, \ottmv{x}  \Rightarrow  \ottnt{e''}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x'}  \Rightarrow  \ottnt{e'''}  \longrightarrow  Case \, \ottnt{e'} \, of \, Left tag \, \ottmv{x}  \Rightarrow  \ottnt{e''}  \ottsym{\mbox{$\mid$}} \, Right tag \, \ottmv{x'}  \Rightarrow  \ottnt{e'''}}{%
{\ottdrulename{JO\_red\_evalcase}}{}%
}}

\newcommand{\ottdefnJOXXred}[1]{\begin{ottdefnblock}[#1]{$\ottnt{e}  \longrightarrow  \ottnt{e'}$}{}
\ottusedrule{\ottdruleJOXXredXXapp{}}
\ottusedrule{\ottdruleJOXXredXXlet{}}
\ottusedrule{\ottdruleJOXXredXXlive{}}
\ottusedrule{\ottdruleJOXXredXXdie{}}
\ottusedrule{\ottdruleJOXXredXXforkOne{}}
\ottusedrule{\ottdruleJOXXredXXforkTwo{}}
\ottusedrule{\ottdruleJOXXredXXforkdeath{}}
\ottusedrule{\ottdruleJOXXredXXret{}}
\ottusedrule{\ottdruleJOXXredXXevalbind{}}
\ottusedrule{\ottdruleJOXXredXXdobind{}}
\ottusedrule{\ottdruleJOXXredXXcutinOne{}}
\ottusedrule{\ottdruleJOXXredXXcutinval{}}
\ottusedrule{\ottdruleJOXXredXXcutinright{}}
\ottusedrule{\ottdruleJOXXredXXcutinright{}}
\ottusedrule{\ottdruleJOXXredXXcontextXXappOne{}}
\ottusedrule{\ottdruleJOXXredXXcontextXXappTwo{}}
\ottusedrule{\ottdruleJOXXredXXcontextXXlet{}}
\ottusedrule{\ottdruleJOXXredXXnotXXOne{}}
\ottusedrule{\ottdruleJOXXredXXnotXXTwo{}}
\ottusedrule{\ottdruleJOXXredXXandXXOne{}}
\ottusedrule{\ottdruleJOXXredXXandXXTwo{}}
\ottusedrule{\ottdruleJOXXredXXpairXXOne{}}
\ottusedrule{\ottdruleJOXXredXXpairXXTwo{}}
\ottusedrule{\ottdruleJOXXredXXevalinl{}}
\ottusedrule{\ottdruleJOXXredXXevalinr{}}
\ottusedrule{\ottdruleJOXXredXXevalcaseinl{}}
\ottusedrule{\ottdruleJOXXredXXevalcaseinr{}}
\ottusedrule{\ottdruleJOXXredXXevalcase{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsJop}{
\ottdefnJOXXred{}}

\newcommand{\ottdefnss}{
\ottdefnsJtype
\ottdefnsJop
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

\begin{document}
\ottall

\begin{verbatim}
Definition rules:        51 good    0 bad
Definition rule clauses: 91 good    0 bad
\end{verbatim}
\end{document}
